---
interface Props {
  /** El rol del elemento anchor. */
  role?: 'anchor' | 'button';
  /** La variante visual del botón. */
  variant?: 'text' | 'platted' | 'borderless';
  /** El color del botón. */
  action?: 'default' | 'neutral';
  /** El tamaño del ancla. */
  size?: 'small' | 'medium' | 'large';
  /** El ancho del botón.*/
  wide?: 'fit' | 'fill';
  /** Si el botón debe estar deshabilitado. */
  disabled?: boolean;
  /** El tipo de contenido. */
  label?: 'TextOnly' | 'IconOnly' | 'TextAndIcon';
  /** If 'Label' is set on 'TextAndIcon' then: */
  Icon?: 'before' | 'after';
  /** Clases CSS adicionales para personalizar. */
  class?: string;
  /** Atributos adicionales como `onclick`, `id`, `data-*`, etc. */
  [key: string]: any;
}

// 1. Desestructurar props con valores por defecto.
const {
  type = 'anchor',
  variant = 'text',
  action = 'default',
  size = 'medium',
  wide = 'fit',
  disabled = false,
  text,
  class: userClass,
  ...rest
} = Astro.props;

// 2. Lógica para determinar los atributos.
const attrs: Record<string, any> = {
  ...rest,
  // Atributos de accesibilidad y funcionales.
  type: type,
  disabled: disabled,
  'aria-disabled': disabled ? 'true' : undefined,
  tabindex: disabled ? -1 : undefined,
};

// 3. Comprobar si se están usando los slots para los símbolos.
const hasSymbol = Astro.slots.has('symbol');

// 4. Construir la lista de clases dinámicamente.
const classList = [
  'anchor',
  `variant-${variant}`,
  `action-${action}`,
  `size-${size}`,
  `wide-${wide}`,
  userClass,
  hasSymbol && 'has-symbol',
].filter(Boolean).join(' '); // `filter(Boolean)` elimina valores falsy (como `false` o `undefined`).

const { href, class: className, ...props } = Astro.props;

const pathname = Astro.url.pathname.replace(import.meta.env.BASE_URL, '');
const subpath = pathname.match(/[^\/]+/g);
const isActive = href === pathname || href === '/' + (subpath?.[0] || '');
---
<a href={href} class:list={[className]} aria-current={isActive ? 'page' : undefined} {...props} {...attrs}>
  <slot />
</a>
<style>
  :is(a, a[role="button"]).anchor {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    width: fit-content;
    height: fit-content;
    font-family: var(--font-family-sans);
    font-weight: var(--font-weight-regular);
    font-size: var(--font-size-22);
    text-transform: uppercase;
    backface-visibility: hidden;
    -webkit-font-smoothing: subpixel-antialiased;
    touch-action: manipulation;
    will-change: color, transform;
    transition: color 150ms, transform 150ms;
    transform: scale(1) translate3d(0px, 0px, 0px) perspective(1px);
    &[aria-current="page"] {
      cursor: default;
      pointer-events: none
    }
    &:focus-visible {
      outline: 2px solid var(--color-focus)
    }
    &.anchor-platter {
      padding: 8px 10px;
      border-radius: 8px;
      background: var(--color-anchor-bg);
      border-color: var(--color-anchor-border);
      color: var(--color-anchor);
      &[aria-current="page"] {
        font-weight: var(--font-weight-bold);
        color: var(--color-label-primary);
        background-color: var(--color-anchor-bg-active)
      }
      @media (hover: hover) {
        &:hover {
          --color-anchor-hover: okchl(1 1 1 / 0.08);
          background-color: var(--color-anchor-hover)
        }
      }
    }
    &[role="button"] {
      
    }
    &[role="button"][aria-pressed="true"] {
      
    }
  }
</style>